
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Nebulas Guide</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#quickstart" class="toc-h1 toc-link" data-title="quickstart">Quickstart</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-react-app" class="toc-h2 toc-link" data-title="create-react-app">Create React app</a>
                  </li>
                  <li>
                    <a href="#write-smart-contract" class="toc-h2 toc-link" data-title="write-smart-contract">Write Smart Contract</a>
                  </li>
                  <li>
                    <a href="#deploy-smart-contract" class="toc-h2 toc-link" data-title="deploy-smart-contract">Deploy Smart Contract</a>
                  </li>
                  <li>
                    <a href="#read-from-smart-contract" class="toc-h2 toc-link" data-title="read-from-smart-contract">Read from Smart Contract</a>
                  </li>
                  <li>
                    <a href="#write-to-smart-contract" class="toc-h2 toc-link" data-title="write-to-smart-contract">Write to Smart Contract</a>
                  </li>
                  <li>
                    <a href="#add-validation" class="toc-h2 toc-link" data-title="add-validation">Add Validation</a>
                  </li>
                  <li>
                    <a href="#deploy-to-production" class="toc-h2 toc-link" data-title="deploy-to-production">Deploy to Production</a>
                  </li>
                  <li>
                    <a href="#next-steps" class="toc-h2 toc-link" data-title="next-steps">Next steps</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api" class="toc-h1 toc-link" data-title="api">API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#blockchain" class="toc-h2 toc-link" data-title="blockchain">Blockchain</a>
                  </li>
                  <li>
                    <a href="#localcontractstorage" class="toc-h2 toc-link" data-title="localcontractstorage">LocalContractStorage</a>
                  </li>
                  <li>
                    <a href="#bignumber" class="toc-h2 toc-link" data-title="bignumber">BigNumber</a>
                  </li>
                  <li>
                    <a href="#event" class="toc-h2 toc-link" data-title="event">Event</a>
                  </li>
                  <li>
                    <a href="#math-random" class="toc-h2 toc-link" data-title="math-random">Math.random</a>
                  </li>
                  <li>
                    <a href="#date" class="toc-h2 toc-link" data-title="date">Date</a>
                  </li>
                  <li>
                    <a href="#accept" class="toc-h2 toc-link" data-title="accept">Accept</a>
                  </li>
                  <li>
                    <a href="#external-contract-call" class="toc-h2 toc-link" data-title="external-contract-call">External Contract Call</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='http://soulchain.org'>Soulchain.org</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>This is Nebulas Guide. Use this guide to get ahead on blockchain programming on Nebulas. This guide includes both a step-by-step tutorial to build a dapp from scratch and deploy it to production and documentation for the most frequently used properties on Nebulas. To follow this guide, you only need to know JavaScript and <a href="https://reactjs.org/">React</a>.</p>
<h1 id='quickstart'>Quickstart</h1>
<p>In Quickstart, we will build a dapp from scratch and deploy it to production. In this section, we will build a simple React app that interacts with a smart contract on Nebulas.</p>
<h2 id='create-react-app'>Create React app</h2>
<blockquote>
<p>Create a react app:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>npm install -g create-react-app

<span class="gp">$ </span>create-react-app my-nebulas
</code></pre>
<blockquote>
<p>Verify that your react app is created successfully:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span><span class="nb">cd </span>my-nebulas

<span class="gp">$ </span>yarn start
</code></pre>
<p>You should see this screen when your react app is running.</p>

<p><img src="images/react-start.png" alt="React" /></p>

<p>For our first app, we will build an app that lets users share doc pictures on Nebulas. For now, let&#39;s just grab a cute dog picture and show it in our app.</p>

<blockquote>
<p>Modify your React component like this:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Create mock dog objects. We will replace these with</span>
    <span class="c1">// real data later.</span>
    <span class="kr">const</span> <span class="nx">dogs</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog1"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"https://woniesong92.github.io/nebulasguide/images/dog1.jpg"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog2"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"https://woniesong92.github.io/nebulasguide/images/dog2.jpg"</span>
      <span class="p">},</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">dog</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/div&gt; </span><span class="err"> 
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre>
<p>Here is an adorable picture:</p>

<p><img src="images/dog1.jpg" alt="Dog1" /></p>

<p>Once you&#39;ve modified your React app, you should be seeing two dogs with labels and pictures.
We are <em>mocking</em> data here with a couple of dog objects. Let&#39;s replace them with actual data from Nebulas!</p>
<h2 id='write-smart-contract'>Write Smart Contract</h2>
<blockquote>
<p>Create a new contract file:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>mkdir contract
<span class="gp">$ </span>vim contract/firstcontract.js
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">// contract/firstcontract.js</span>
<span class="kd">var</span> <span class="nx">Dog</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">jsonString</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">jsonString</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">jsonString</span><span class="p">)</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">name</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">url</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s2">""</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">Dog</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">FirstContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Define storage properties (i.e. we will have two "storage variables" in our contract)</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"numDogs"</span><span class="p">)</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineMapProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"dogs"</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">FirstContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// init() will run when you first deploy</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="kd">var</span> <span class="nx">dogs</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog1"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"https://woniesong92.github.io/nebulasguide/images/dog1.jpg"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog2"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"https://woniesong92.github.io/nebulasguide/images/dog2.jpg"</span>
      <span class="p">},</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">dog</span> <span class="o">=</span> <span class="nx">dogs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="c1">// addDog() will add a new dog to your contract's storage</span>
  <span class="na">addDog</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">name</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
    <span class="p">}))</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span><span class="p">,</span> <span class="nx">dog</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">},</span>

  <span class="na">getDogs</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">dogs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>

      <span class="nx">dogs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">dog</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">dogs</span>
  <span class="p">},</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">FirstContract</span>
</code></pre>
<p>Let&#39;s write our first smart contract. A smart contract is basically just a javascript file that will have access to Nebulas&#39; API when deployed.
Unlike Ethereum, you do not have to learn a new langauge (e.g. Solidity).</p>

<p>In this simple smart contract, we first define a simple <code>Dog</code> constructor that takes in a stringified json and creates a <code>Dog</code> object.</p>

<p>Then, we define the main contract with only a few functions: <code>init</code>, <code>addDog</code>, and <code>getDogs</code>. When you define an <code>init</code> function, this will be executed when you first deploy your smtart contract to Nebulas. For example, if you want to <em>populate</em> your contract with a few cute dogs before users upload new dogs, this is the right place.</p>

<p>If you already know JavaSript, every line should be familar except for the lines that have <code>LocalContractStorage</code> in them. <code>LocalContractStorage</code> is a reserved function, which lets you have access to Nebulas&#39; storage. Think of <code>LocalContractStorage.defineProperty(this, &quot;numDogs&quot;)</code> as saying <em>&quot;I am going to create a persistent variable <code>numDogs</code> in Nebulas&quot;</em>. The difference between <code>defineProperty</code> and <code>defineMapProperty</code> is simply that the former is a primitive-type store while the latter is a key-value store.</p>
<h2 id='deploy-smart-contract'>Deploy Smart Contract</h2>
<blockquote>
<p>Download Web Wallet</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>git clone git@github.com:nebulasio/web-wallet.git
<span class="gp">$ </span><span class="nb">cd </span>web-wallet

// Open index.html <span class="k">in </span>your browser and create a wallet on Testnet
</code></pre>
<p>We are ready to deploy our simple contract to Nebulas. To deploy a contract to Nebulas, you need to have some NAS, the currency used on Nebulas&#39; network. To get NAS and deploy a contract to Nebulas, you need the <a href="https://github.com/nebulasio/web-wallet">Web Wallet</a>. Download it and open <code>index.html</code> in your browser to see the interface.</p>

<p><img src="images/web-wallet1.jpg" alt="Web Wallet" /></p>

<p>We are going to deploy our contract to Testnet. Think of Testnet as a staging server and Mainnet as production server. We will deploy to Testnet because it will let us test our contract without spending real NAS. You can ask for free NAS on Testnet by visiting the <a href="https://testnet.nebulas.io/claim">Faucet</a>. For wallet address, you can use the one you just created. You will have your free NAS within minutes.</p>

<p>Now that we have some NAS on Testnet, we can finally deploy our contract to Testnet. Go to the Contract tab, and simply copy our contract&#39;s content and paste it into the code section.</p>

<p><img src="images/deploy.jpg" alt="Deploy" /></p>

<p>After you deploy (i.e. submit) your contract, you will get the transaction hash and the deployed contract&#39;s address. Copy the address, as we will have to use it in our React app to interact with the contract.</p>

<p><img src="images/contract-address.jpg" alt="Contract Address" /></p>

<p>Congratulations! You have your first contract deployed to Nebulas.</p>
<h2 id='read-from-smart-contract'>Read from Smart Contract</h2>
<blockquote>
<p>Install Nebulas package in your React app</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>yarn add nebulas
</code></pre>
<blockquote>
<p>Use the dog objects from contract in your React app</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span>
<span class="kr">import</span> <span class="nx">nebulas</span> <span class="nx">from</span> <span class="s1">'nebulas'</span>

<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">dogs</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">componentWillMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fetchDogs</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="nx">fetchDogs</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">CONTRACT_ADDRESS</span> <span class="o">=</span> <span class="s2">"YOUR_CONTRACT_ADDRESS"</span>
    <span class="kr">const</span> <span class="nx">AUTHOR_ADDRESS</span> <span class="o">=</span> <span class="s2">"YOUR_WALLET_ADDRESS"</span>
    <span class="kr">const</span> <span class="nx">NEBULAS_URL</span> <span class="o">=</span> <span class="s2">"https://testnet.nebulas.io"</span>
    <span class="kr">const</span> <span class="nx">Account</span> <span class="o">=</span> <span class="nx">nebulas</span><span class="p">.</span><span class="nx">Account</span>
    <span class="kr">const</span> <span class="nx">neb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nebulas</span><span class="p">.</span><span class="nx">Neb</span><span class="p">()</span>
    <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nebulas</span><span class="p">.</span><span class="nx">HttpRequest</span><span class="p">(</span><span class="nx">NEBULAS_URL</span><span class="p">)</span>
    <span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="s2">"0"</span>
    <span class="kr">const</span> <span class="nx">nonce</span> <span class="o">=</span> <span class="s2">"0"</span>
    <span class="kr">const</span> <span class="nx">gas_price</span> <span class="o">=</span> <span class="s2">"1000000"</span>
    <span class="kr">const</span> <span class="nx">gas_limit</span> <span class="o">=</span> <span class="s2">"2000000"</span>
    <span class="kr">const</span> <span class="nx">callFunction</span> <span class="o">=</span> <span class="s2">"getDogs"</span>
    <span class="kr">const</span> <span class="nx">callArgs</span> <span class="o">=</span> <span class="s2">""</span>  
    <span class="kr">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">"function"</span><span class="p">:</span> <span class="nx">callFunction</span><span class="p">,</span>
      <span class="s2">"args"</span><span class="p">:</span> <span class="nx">callArgs</span>
    <span class="p">}</span>

    <span class="nx">neb</span><span class="p">.</span><span class="nx">setRequest</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span>
    <span class="nx">neb</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
      <span class="nx">AUTHOR_ADDRESS</span><span class="p">,</span>
      <span class="nx">CONTRACT_ADDRESS</span><span class="p">,</span>
      <span class="nx">value</span><span class="p">,</span> <span class="nx">nonce</span><span class="p">,</span>
      <span class="nx">gas_price</span><span class="p">,</span> <span class="nx">gas_limit</span><span class="p">,</span>
      <span class="nx">contract</span>
    <span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">resp</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">dogs</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">resp</span><span class="p">.</span><span class="nx">result</span><span class="p">),</span>
      <span class="p">})</span>
    <span class="p">}).</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"error:"</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">dogs</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">dog</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/div&gt; </span><span class="err"> 
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Now that we have deployed our contract to Nebulas, we are ready to replace our mock data in our React app with actual the data from our contract in Nebulas.</p>

<p>To interact with the smart contract, you need to install the <a href="https://www.npmjs.com/package/nebulas">nebulas package</a> in your React app. Then, we will call the <code>getDogs()</code> function in our smart contract via the API in <code>componentWillMount()</code> and update our state. For now, do not worry too much about the parameters we pass into <code>neb.api.call</code> as you will get used to them naturally as you interact more with your contract in future.</p>

<p>If you did everything correctly, you should see exactly the same screen as you saw when you go to your React app. However this time, the dog objects are coming straight from the smart contract instead of the static mock data. After all, interacting with Nebulas is just as simple as interacting with a 3rd-party API service.</p>
<h2 id='write-to-smart-contract'>Write to Smart Contract</h2>
<blockquote>
<p>Install <a href="https://www.npmjs.com/package/nebpay">nebpay</a> package</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>yarn add nebpay
</code></pre>
<blockquote>
<p>Add a button to add a dog and the corresponding handler</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span>
<span class="kr">import</span> <span class="nx">nebulas</span> <span class="nx">from</span> <span class="s1">'nebulas'</span>
<span class="kr">import</span> <span class="nx">NebPay</span> <span class="nx">from</span> <span class="s1">'nebpay'</span>

<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="nx">onAddDog</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">newDog</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s2">"myDog"</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s2">"https://woniesong92.github.io/nebulasguide/images/dog3.jpg"</span>
    <span class="p">}</span>
    <span class="kr">const</span> <span class="nx">nebPay</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NebPay</span><span class="p">()</span>
    <span class="kr">const</span> <span class="nx">price</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="kr">const</span> <span class="nx">callFunction</span> <span class="o">=</span> <span class="s2">"addDog"</span>
    <span class="kr">const</span> <span class="nx">callArgs</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">([</span><span class="nx">newDog</span><span class="p">])</span>
    <span class="kr">const</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nx">nebPay</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
      <span class="nx">CONTRACT_ADDRESS</span><span class="p">,</span>
      <span class="nx">price</span><span class="p">,</span>
      <span class="nx">callFunction</span><span class="p">,</span>
      <span class="nx">callArgs</span><span class="p">,</span>
      <span class="nx">opts</span><span class="p">,</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">dogs</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">dog</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>          <span class="p">))}</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onAddDog</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Add</span> <span class="nx">Dog</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Remember how we wanted to let users add dogs to our contract? Since our contract already has <code>addDog()</code> function, we just need to add a way for our React app to call this function. In other words, we need to add a button and its corresponding handler. For now, let&#39;s skip adding an input field and just have users add <em>a dog</em> with the same name and image.</p>

<p>When you look at the function <code>onAddDog()</code> on the right side, you will notice that it is extremly similar to the function <code>fetchDogs()</code> we wrote above. The biggest difference is that instead of using the nebulas api directly, we are now using the <code>nebpay</code> package. This package lets users interact with your smart contract directly via either the <a href="https://github.com/ChengOrangeJu/WebExtensionWallet">Chrome extension</a> or the mobile nebulas wallet. In other words, <code>nebpay</code> lets end users sign and send transactions to your smart contract.</p>

<p>Why is it needed? It&#39;s because altering the state in Nebulas blockchain requires a small amount of NAS, just like how Ethereum requires GAS for altering its state. While calling the <code>getDogs()</code> function does not alter the state, <code>addDog()</code> does. Consequently, users who want to add a dog to your smart contract must sign and send the transaction to your contract by paying a small fee. <code>nebpay</code> allows you to implement such interaction as easily as just using the <code>nebulas</code> package.</p>

<p>As a result of <code>nebPay.call()</code>, you get a transaction hash and you can optionally pass in a listener to know when the transaction has been confirmed. However, for now, we will just leave the code as simple as it is on the right side. Try clicking the button <code>Add Dog</code> and refresh the page in 30 seconds to 1 minute (i.e. the time it takes for the transaction to be confirmed on Testnet). Verify that you see an added dog in your app.</p>
<h2 id='add-validation'>Add Validation</h2>
<blockquote>
<p>Add a new property <code>author</code> where we will store deployer&#39;s address</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">FirstContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"numDogs"</span><span class="p">)</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineMapProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"dogs"</span><span class="p">)</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"author"</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre>
<blockquote>
<p>In <code>init()</code>, set author to be the deployer (i.e. you)
and check if the sender is the author in <code>addDog()</code></p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">FirstContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span>
  <span class="p">},</span>
  <span class="na">addDog</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">author</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"You are not the author"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">name</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
    <span class="p">}))</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span><span class="p">,</span> <span class="nx">dog</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre>
<p>But do you really want to let everyone add Dog to your app? Well, adding a dog to your app now is harmless, but what if you want to build a <a href="http://naswarriors.soulchain.org">dapp</a> that should only let authors add new items?</p>

<p>To do this, we need to add validation. More specifically, in the function that adds a new dog, we need to check whether the <em>user</em> (i.e. the person who just sent a transaction to our contract) is the author. In other words, we want to validate that <code>user.address === author.address</code>. How do we get the author&#39;s address and the user&#39;s address?</p>

<p>The author is the person who deploys the app. In the <code>init()</code> function, we have access to the deployer&#39;s address in the property <code>Blockchain.transaction.from</code>. <code>Blockchain.transaction</code> is also another special object that is available in a Nebulas smart contract that lets you access certain properties of a transaction. The counterpart of <code>Blockchain.transaction.from</code> is <code>Blockchain.transaction.to</code>. For now, we just need to add a new property <code>author</code> after <code>dogs</code> and <code>numDogs</code> so that we can store the author&#39;s address.</p>

<p>In the function <code>addDog()</code> we can access the user&#39;s address the same way. Compare it with the author&#39;s address that we stored in the <code>init()</code> function and throw an error if they don&#39;t match. When you throw an error, the function will return with the error immediately. On the front end, if the contract throws any kind of an error as a result of user&#39;s transaction, you will get the error&#39;s message in response.</p>
<h2 id='deploy-to-production'>Deploy to Production</h2>
<p>This is the final section of the Quickstart! Now that we have built our first dapp, we have to deploy to production to be able to share it with other users. Deploying to production means hosting your frontend in a public address and deploying your smart contract to Mainnet.</p>
<h3 id='host-your-frontend'>Host your frontend</h3>
<p>If you want to use Nebulas as the primary backend, hosting your frontend is easy and free. Just build your project with yarn and upload your build folder to your favorite hosting service. This <a href="https://www.codementor.io/yurio/all-you-need-is-react-firebase-4v7g9p4kf">guide</a> goes through how you can host your React app with Firebase. You can also just host it on <a href="https://pages.github.com/">GitHub Pages</a>. Whichever platform you decide to use, remember to change your Nebulas URL from <code>https://testnet.nebulas.io</code> to <code>https://mainnet.nebulas.io</code>.</p>

<p>If you want to use your own backend in addition to Nebulas, here are a few options: <a href="https://heroku.com">Heroku</a>, <a href="https://www.digitalocean.com/">Digital Ocean</a>, <a href="https://aws.amazon.com/ec2/">AWS EC2</a>.</p>
<h3 id='deploy-your-contract-to-mainnet'>Deploy your contract to Mainnet</h3>
<p>Deploying your contract to Mainnet is exactly the same as deploying it to Testnet. Simply choose Mainnet instead of Testnet for your deployment environment. The main difference is that to deploy to Mainnet, you need real NAS (i.e. you cannot use the NAS you got from the testnet faucet). To get real NAS, you can purchase it from the <a href="https://coinmarketcap.com/currencies/nebulas-token/#markets">exchanges</a> that have NAS and transfer it to your Mainnet wallet.</p>

<p><img src="images/web-wallet2.jpg" alt="Web-wallet2" /></p>

<p>Congratulations! Now you have officially built and deployed a Dapp to the world.</p>
<h2 id='next-steps'>Next steps</h2>
<p>Check out the following places to learn about Nebulas further.</p>

<ul>
<li><a href="#api">API document</a></li>
<li><a href="https://nebulas.io/resources.html">Nebulas Resources</a></li>
<li><a href="https://www.reddit.com/r/nebulas">Nebulas Subreddit</a></li>
<li><a href="https://medium.com/@nebulasio">Nebulas Medium</a></li>
</ul>
<h1 id='api'>API</h1><h2 id='blockchain'>Blockchain</h2>
<blockquote>
<p>Blockchain API Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">SampleContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineProperties</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="na">count</span><span class="p">:</span> <span class="kc">null</span>
    <span class="p">});</span>
    <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineMapProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"allocation"</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">SampleContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">init</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">count</span><span class="p">,</span> <span class="nx">allocation</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="nx">count</span><span class="p">;</span>
      <span class="nx">allocation</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">allocation</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span>
      <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.block.coinbase = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">coinbase</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.block.hash = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.block.height = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">block</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.transaction.from = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.transaction.to = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">to</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.transaction.value = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.transaction.nonce = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">nonce</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'init: Blockchain.transaction.hash = '</span> <span class="o">+</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">transfer</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transfer</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"transfer result:"</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
      <span class="nx">Event</span><span class="p">.</span><span class="nx">Trigger</span><span class="p">(</span><span class="s2">"transfer"</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">Transfer</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">from</span><span class="p">:</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">to</span><span class="p">,</span>
          <span class="na">to</span><span class="p">:</span> <span class="nx">address</span><span class="p">,</span>
          <span class="na">value</span><span class="p">:</span> <span class="nx">value</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">},</span>
    <span class="na">verifyAddress</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">verifyAddress</span><span class="p">(</span><span class="nx">address</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"verifyAddress result:"</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">SampleContract</span><span class="p">;</span>
</code></pre>
<p><em>Blockchain top-level API</em></p>

<ul>
<li><code>Blockchain.block</code>

<ul>
<li>current block </li>
</ul></li>
<li><code>Blockchain.transaction</code>

<ul>
<li>current transaction, transaction&#39;s value/gasPrice/gasLimit as BigNumber</li>
</ul></li>
<li><code>Blockchain.transfer(address, value)</code>

<ul>
<li>transfer NAS from contract to address</li>
</ul></li>
<li><code>Blockchain.verifyAddress(address)</code>

<ul>
<li>verify address</li>
</ul></li>
</ul>

<p><em>Blockchain.properties</em></p>

<ul>
<li><code>block</code>: current block for contract execution

<ul>
<li><code>timestamp</code>: block timestamp</li>
<li><code>seed</code>: random seed</li>
<li><code>height</code>: block height</li>
</ul></li>
<li><code>transaction</code>: current transaction for contract execution

<ul>
<li><code>hash</code>: transaction hash</li>
<li><code>from</code>: transaction from address</li>
<li><code>to</code>: transaction to address</li>
<li><code>value</code>: transaction value, a BigNumber object for contract use</li>
<li><code>nonce</code>: transaction nonce</li>
<li><code>timestamp</code>: transaction timestamp</li>
<li><code>gasPrice</code>: transaction gasPrice, a BigNumber object for contract use</li>
<li><code>gasLimit</code>: transaction gasLimit, a BigNumber object for contract use</li>
</ul></li>
<li><code>transfer(address, value)</code>: transfer NAS from contract to address

<ul>
<li>params:</li>
<li><code>address</code>: nebulas address to receive NAS</li>
<li><code>value</code>: transfer value, a BigNumber object. The unit is wei, only integer value is valid.</li>
<li>return (boolean value):</li>
<li><code>true</code>: transfer success</li>
<li><code>false</code>: transfer failed<br></li>
</ul></li>
<li><code>verifyAddress(address)</code>: verify address

<ul>
<li>params:</li>
<li><code>address</code>: address need to check</li>
<li>return (number value):</li>
<li><code>87</code>: user wallet address</li>
<li><code>88</code>: smart-contract address</li>
<li><code>0</code>: address is invalid </li>
</ul></li>
</ul>
<h2 id='localcontractstorage'>LocalContractStorage</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">FirstContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Use `defineProperty` to store primitive-type values</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"author"</span><span class="p">)</span>

  <span class="c1">// Use `defineMapProperty` to store key-value-type values</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineMapProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"dogFamily"</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">FirstContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dogFamily</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"dad"</span><span class="p">,</span> <span class="s2">"Marlie"</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dogFamily</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"mom"</span><span class="p">,</span> <span class="s2">"Lucy"</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="na">getDad</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">dogFamily</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"dad"</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="na">setFamilyMember</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">memberType</span><span class="p">,</span> <span class="nx">memberName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dogFamily</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">memberType</span><span class="p">,</span> <span class="nx">memberName</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Module implementation</p>
</blockquote>
<pre class="highlight typescript tab-typescript"><code><span class="kr">interface</span> <span class="nx">Descriptor</span> <span class="p">{</span>
  <span class="c1">// serialize value to string;</span>
  <span class="nx">stringify</span><span class="p">?(</span><span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">):</span> <span class="kr">string</span><span class="p">;</span>

  <span class="c1">// deserialize value from string;</span>
  <span class="nx">parse</span><span class="p">?(</span><span class="nx">value</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">any</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">DescriptorMap</span> <span class="p">{</span>
  <span class="p">[</span><span class="nx">fieldName</span><span class="p">:</span> <span class="kr">string</span><span class="p">]:</span> <span class="nx">Descriptor</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">ContractStorage</span> <span class="p">{</span>
  <span class="c1">// get and return value by key from Native Storage.</span>
  <span class="nx">rawGet</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">string</span><span class="p">;</span>
  <span class="c1">// set key and value pair to Native Storage,</span>
  <span class="c1">// return 0 for success, otherwise failure.</span>
  <span class="nx">rawSet</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">number</span><span class="p">;</span>

  <span class="c1">// define a object property named `fieldname` to `obj` with descriptor.</span>
  <span class="c1">// default descriptor is JSON.parse/JSON.stringify descriptor.</span>
  <span class="c1">// return this.</span>
  <span class="nx">defineProperty</span><span class="p">(</span><span class="nx">obj</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">fieldName</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">descriptor</span><span class="p">?:</span> <span class="nx">Descriptor</span><span class="p">):</span> <span class="kr">any</span><span class="p">;</span>

  <span class="c1">// define object properties to `obj` from `props`.</span>
  <span class="c1">// default descriptor is JSON.parse/JSON.stringify descriptor.</span>
  <span class="c1">// return this.</span>
  <span class="nx">defineProperties</span><span class="p">(</span><span class="nx">obj</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">props</span><span class="p">:</span> <span class="nx">DescriptorMap</span><span class="p">):</span> <span class="kr">any</span><span class="p">;</span>

  <span class="c1">// define a StorageMap property named `fieldname` to `obj` with descriptor.</span>
  <span class="c1">// default descriptor is JSON.parse/JSON.stringify descriptor.</span>
  <span class="c1">// return this.</span>
  <span class="nx">defineMapProperty</span><span class="p">(</span><span class="nx">obj</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">fieldName</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">descriptor</span><span class="p">?:</span> <span class="nx">Descriptor</span><span class="p">):</span> <span class="kr">any</span><span class="p">;</span>

  <span class="c1">// define StorageMap properties to `obj` from `props`.</span>
  <span class="c1">// default descriptor is JSON.parse/JSON.stringify descriptor.</span>
  <span class="c1">// return this.</span>
  <span class="nx">defineMapProperties</span><span class="p">(</span><span class="nx">obj</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="nx">props</span><span class="p">:</span> <span class="nx">DescriptorMap</span><span class="p">):</span> <span class="kr">any</span><span class="p">;</span>

  <span class="c1">// delete key from Native Storage.</span>
  <span class="c1">// return 0 for success, otherwise failure.</span>
  <span class="nx">del</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">number</span><span class="p">;</span>

  <span class="c1">// get value by key from Native Storage,</span>
  <span class="c1">// deserialize value by calling `descriptor.parse` and return.</span>
  <span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">any</span><span class="p">;</span>

  <span class="c1">// set key and value pair to Native Storage,</span>
  <span class="c1">// the value will be serialized to string by calling `descriptor.stringify`.</span>
  <span class="c1">// return 0 for success, otherwise failure.</span>
  <span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">):</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">StorageMap</span> <span class="p">{</span>
  <span class="c1">// delete key from Native Storage, return 0 for success, otherwise failure.</span>
  <span class="nx">del</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">number</span><span class="p">;</span>

  <span class="c1">// get value by key from Native Storage,</span>
  <span class="c1">// deserialize value by calling `descriptor.parse` and return.</span>
  <span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">any</span><span class="p">;</span>

  <span class="c1">// set key and value pair to Native Storage,</span>
  <span class="c1">// the value will be serialized to string by calling `descriptor.stringify`.</span>
  <span class="c1">// return 0 for success, otherwise failure.</span>
  <span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="kr">any</span><span class="p">):</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<p>The <code>LocalContractStorage</code> module provides a state trie based storage capability. It accepts string only key value pairs. And all data are stored to a private state trie associated with current contract address, only the contract can access them.</p>
<h2 id='bignumber'>BigNumber</h2><pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">zero</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">one</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">two</span> <span class="o">=</span> <span class="nx">one</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"is greater than"</span><span class="p">,</span> <span class="nx">two</span><span class="p">.</span><span class="nx">gt</span><span class="p">(</span><span class="nx">one</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"is greater than or equal to"</span><span class="p">,</span> <span class="nx">two</span><span class="p">.</span><span class="nx">gte</span><span class="p">(</span><span class="nx">one</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"is less than"</span><span class="p">,</span> <span class="nx">one</span><span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="nx">two</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"is less than or equal to"</span><span class="p">,</span> <span class="nx">one</span><span class="p">.</span><span class="nx">lte</span><span class="p">(</span><span class="nx">one</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"is equal to"</span><span class="p">,</span> <span class="nx">one</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="nx">one</span><span class="p">))</span>
</code></pre>
<p>The <code>BigNumber</code> module use the <a href="https://github.com/MikeMcl/bignumber.js">bignumber.js</a>(v4.1.0), a JavaScript library for arbitrary-precision decimal and non-decimal arithmetic. The contract can use <code>BigNumber</code> directly to handle the value of the transaction and other values transfer.</p>
<h2 id='event'>Event</h2><pre class="highlight javascript tab-javascript"><code>  <span class="c1">// Event.Trigger("eventName", customObject)</span>

  <span class="nx">Event</span><span class="p">.</span><span class="nx">Trigger</span><span class="p">(</span><span class="s2">"transfer"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">Transfer</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">from</span><span class="p">:</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">to</span><span class="p">,</span>
      <span class="na">to</span><span class="p">:</span> <span class="nx">address</span><span class="p">,</span>
      <span class="na">value</span><span class="p">:</span> <span class="nx">value</span>
    <span class="p">}</span>
  <span class="p">});</span>
</code></pre>
<p>The <code>Event</code> module records execution events in contract. The recorded events are stored in the event trie on the chain, which can be fetched by <a href="https://github.com/nebulasio/wiki/blob/master/rpc.md#geteventsbyhash"><code>GetEventsByHash</code></a>API with the execution transaction hash. All contract event topics have a <code>chain.contract.</code> prefix before the topic they set in contract.</p>
<h2 id='math-random'>Math.random</h2>
<blockquote>
<p>Math.random()</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">BankVaultContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>

<span class="nx">BankVaultContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{},</span>
  <span class="na">game</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">subscript</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">];</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">rand</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">rand</span><span class="p">];</span>
      <span class="nx">arr</span><span class="p">[</span><span class="nx">rand</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">t</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">arr</span><span class="p">[</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">subscript</span><span class="p">)];</span>
  <span class="p">},</span>
<span class="p">};</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">BankVaultContract</span><span class="p">;</span>
</code></pre>
<blockquote>
<p>Math.random.seed(myseed)</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">BankVaultContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>

<span class="nx">BankVaultContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{},</span>
  <span class="na">game</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">subscript</span><span class="p">,</span> <span class="nx">myseed</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">];</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// reset random seed with `myseed`</span>
        <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">.</span><span class="nx">seed</span><span class="p">(</span><span class="nx">myseed</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">rand</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">rand</span><span class="p">];</span>
      <span class="nx">arr</span><span class="p">[</span><span class="nx">rand</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">t</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">arr</span><span class="p">[</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">subscript</span><span class="p">)];</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">BankVaultContract</span><span class="p">;</span>
</code></pre>
<ul>
<li><code>Math.random()</code> returns a floating-point, pseudo-random number in the range from 0 inclusive up to but not including 1. The typical usage is:</li>
<li><code>Math.random.seed(myseed)</code> if needed, you can use this method to reset random seed. The argument <code>myseed</code> must be a <strong>string</strong>.</li>
</ul>
<h2 id='date'>Date</h2><pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">BankVaultContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>

<span class="nx">BankVaultContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{},</span>
  <span class="na">test</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">BankVaultContract</span><span class="p">;</span>
</code></pre>
<p>NOTE:</p>

<ul>
<li>Unsupported methods：<code>toDateString()</code>, <code>toTimeString()</code>, <code>getTimezoneOffset()</code>, <code>toLocaleXXX()</code>.</li>
<li><code>new Date()</code>/<code>Date.now()</code> returns the timestamp of current block in milliseconds.</li>
<li><code>getXXX</code> returns the result of <code>getUTCXXX</code>.</li>
</ul>
<h2 id='accept'>Accept</h2><pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">DepositeContent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">JSONString</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">JSONString</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSONString</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">balance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigNumber</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">balance</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">address</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">address</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">balance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">address</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">DepositeContent</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">BankVaultContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineMapProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"bankVault"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">parse</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">JSONString</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">DepositeContent</span><span class="p">(</span><span class="nx">JSONString</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">stringify</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">o</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="nx">BankVaultContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{},</span>
  <span class="na">save</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">from</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigNumber</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">orig_deposit</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">bankVault</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">from</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">orig_deposit</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">orig_deposit</span><span class="p">.</span><span class="nx">balance</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">deposit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DepositeContent</span><span class="p">();</span>
    <span class="nx">deposit</span><span class="p">.</span><span class="nx">balance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BigNumber</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="nx">deposit</span><span class="p">.</span><span class="nx">address</span> <span class="o">=</span> <span class="nx">from</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bankVault</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">from</span><span class="p">,</span> <span class="nx">deposit</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">accept</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
    <span class="nx">Event</span><span class="p">.</span><span class="nx">Trigger</span><span class="p">(</span><span class="s2">"transfer"</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">Transfer</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">from</span><span class="p">:</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span><span class="p">,</span>
        <span class="na">to</span><span class="p">:</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">to</span><span class="p">,</span>
        <span class="na">value</span><span class="p">:</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">BankVaultContract</span><span class="p">;</span>
</code></pre>
<p>Send a binary transfer to a contract account. As the <code>to</code> is a smart contact address, which has declared a function <code>accept()</code> and it excutes correctly, the transfer will succeed. If the Tx is a non-binary Tx,it will be treated as a normal function.</p>
<h2 id='external-contract-call'>External Contract Call</h2>
<aside class="warning">
  External Contract Call is not available yet in production.
</aside>

<p>We provide a simple method in a smart contract to call another contract, the following example shows that how proxyKvStore provide service by using the contract kvStore.</p>
<pre class="highlight javascript tab-javascript"><code><span class="c1">// proxyKvStore.js:</span>

<span class="kd">var</span> <span class="nx">proxyKvStore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>

<span class="kd">var</span> <span class="nx">contractInterface</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">save</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{},</span>
  <span class="na">get</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{},</span>
<span class="p">}</span>

<span class="nx">proxyKvStore</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span>
  <span class="na">save</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">kvStore</span>  <span class="o">=</span> <span class="k">new</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">contractInterface</span><span class="p">);</span>
    <span class="nx">kvStore</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="mi">20000000000000000</span><span class="p">).</span><span class="nx">save</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="na">saveByCall</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">kvStore</span>  <span class="o">=</span> <span class="k">new</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">contractInterface</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>
    <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
    <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="nx">kvStore</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="mi">20000000000000000</span><span class="p">).</span><span class="nx">call</span><span class="p">(</span><span class="s1">'save'</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">args</span><span class="p">));</span>
  <span class="p">},</span>
  <span class="na">get</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">kvStore</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">contractInterface</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">kvStore</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
  <span class="p">},</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">proxyKvStore</span><span class="p">;</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">// kvStore.js:</span>

<span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">JSONString</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">JSONString</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSONString</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">key</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">item</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">kvStore</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineMapProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"repo"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">parse</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">item</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">stringify</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">o</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="nx">kvStore</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// todo</span>
  <span class="p">},</span>
  <span class="na">save</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
    <span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="o">===</span> <span class="s2">""</span> <span class="o">||</span> <span class="nx">value</span> <span class="o">===</span> <span class="s2">""</span><span class="p">){</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"empty key / value"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">128</span> <span class="o">||</span> <span class="nx">key</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">128</span><span class="p">){</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"key / value exceed limit length"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">from</span> <span class="o">=</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">from</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">repo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">){</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"value has been taken"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">item</span><span class="p">();</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">author</span> <span class="o">=</span> <span class="nx">from</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
    <span class="nx">item</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repo</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">item</span><span class="p">);</span>
  <span class="p">},</span>

    <span class="na">get</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">key</span> <span class="o">=</span> <span class="nx">key</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nx">key</span> <span class="o">===</span> <span class="s2">""</span> <span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">"empty key"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">repo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
    <span class="p">},</span> 

    <span class="na">throwErr</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">throw</span><span class="p">(</span><span class="s2">"err for test"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">kvStore</span><span class="p">;</span>
</code></pre>
<blockquote>
<p>In the example, to use KvStore, we first should define an interface like this:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">contractInterface</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">save</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">},</span>
    <span class="na">get</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Then, create a contract object with the interface and the address of the contract you want to call:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">kvStore</span>  <span class="o">=</span> <span class="k">new</span> <span class="nx">Blockchain</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">address</span><span class="p">,</span> <span class="nx">contractInterface</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>After that, we can call function in KvStore.js thought this object:
<code>javascript
kvStore.value(2000000000000000000).save(key, value);
// or kvStore.save(key, value);
</code></p>

<p>as well as this way, keep the style of calling a function by sendRawTransaction RPC:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">kvStore</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="mi">2000000000000000000</span><span class="p">).</span><span class="nx">call</span><span class="p">(</span><span class="s1">'save'</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">args</span><span class="p">));</span>
</code></pre>
<blockquote>
<p>the &#39;value&#39; function decides how much nas will be transfered to callee contract. It is not necessary， and the default value is 0.
It should be noted that in the execution environment of the callee contract, Blockchain.from returns the address of the caller contract, and Blockchain.value is determined by the parameter of the &#39;value&#39; function executed by the caller contract.</p>
</blockquote>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
