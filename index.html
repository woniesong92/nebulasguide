
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Nebulas Guide</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#quickstart" class="toc-h1 toc-link" data-title="quickstart">Quickstart</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-react-app" class="toc-h2 toc-link" data-title="create-react-app">Create React app</a>
                  </li>
                  <li>
                    <a href="#write-smart-contract" class="toc-h2 toc-link" data-title="write-smart-contract">Write Smart Contract</a>
                  </li>
                  <li>
                    <a href="#deploy-smart-contract" class="toc-h2 toc-link" data-title="deploy-smart-contract">Deploy Smart Contract</a>
                  </li>
                  <li>
                    <a href="#read-from-smart-contract" class="toc-h2 toc-link" data-title="read-from-smart-contract">Read from Smart Contract</a>
                  </li>
                  <li>
                    <a href="#write-to-smart-contract" class="toc-h2 toc-link" data-title="write-to-smart-contract">Write to Smart Contract</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='http://soulchain.org'>Soulchain</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Nebulas Guide! You can use this document to kickstart your project in Nebulas. This guide is authored by <a href="https://howonsong.com/">Howon</a>.</p>

<p>The only prerequisites for this guide are the following:</p>

<ul>
<li>JavaScript</li>
<li>React</li>
</ul>
<h1 id='quickstart'>Quickstart</h1>
<p>In Quickstart, we will deploy a simple React app to Nebulas.</p>
<h2 id='create-react-app'>Create React app</h2>
<blockquote>
<p>Create a react app:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>npm install -g create-react-app

<span class="gp">$ </span>create-react-app my-nebulas
</code></pre>
<blockquote>
<p>Verify that your react app is created successfully:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span><span class="nb">cd </span>my-nebulas

<span class="gp">$ </span>yarn start
</code></pre>
<p>You should see this screen when your react app is running.</p>

<p><img src="images/react-start.png" alt="React" /></p>

<p>For our first app, we will build an app that lets users share doc pictures on Nebulas. For now, let&#39;s just grab a cute dog picture and show it in our app.</p>

<blockquote>
<p>Modify your React component like this:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Create mock dog objects. We will replace these with</span>
    <span class="c1">// real data later.</span>
    <span class="kr">const</span> <span class="nx">dogs</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog1"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"/dog1.jpg"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog2"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"/dog2.jpg"</span>
      <span class="p">},</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">dog</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/div&gt; </span><span class="err"> 
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre>
<p>Here is an adorable picture:</p>

<p><img src="images/dog1.jpg" alt="Dog1" /></p>

<p>Once you&#39;ve modified your React app, you should be seeing two dogs with labels and pictures.
We are <em>mocking</em> data here with a couple of dog objects. Let&#39;s replace them with actual data from Nebulas!</p>
<h2 id='write-smart-contract'>Write Smart Contract</h2>
<blockquote>
<p>Create a new contract file:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>mkdir contract
<span class="gp">$ </span>vim contract/firstcontract.js
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="c1">// contract/firstcontract.js</span>
<span class="kd">var</span> <span class="nx">Dog</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">jsonString</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">jsonString</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">jsonString</span><span class="p">)</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">name</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">url</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="s2">""</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">Dog</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">toString</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">FirstContract</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Define storage properties (i.e. we will have two "storage variables" in our contract)</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"numDogs"</span><span class="p">)</span>
  <span class="nx">LocalContractStorage</span><span class="p">.</span><span class="nx">defineMapProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"dogs"</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">FirstContract</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// init() will run when you first deploy</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="kd">var</span> <span class="nx">dogs</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog1"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"dog1.jpg"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"Dog2"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"dog2.jpg"</span>
      <span class="p">},</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">dog</span> <span class="o">=</span> <span class="nx">dogs</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="c1">// addDog() will add a new dog to your contract's storage</span>
  <span class="na">addDog</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">name</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span>
    <span class="p">}))</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span><span class="p">,</span> <span class="nx">dog</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">},</span>

  <span class="na">getDogs</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">dogs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">numDogs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>

      <span class="nx">dogs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">dog</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">dogs</span>
  <span class="p">},</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">FirstContract</span>
</code></pre>
<p>Let&#39;s write our first smart contract. A smart contract is basically just a javascript file that will have access to Nebulas&#39; API when deployed.
Unlike Ethereum, you do not have to learn a new langauge (e.g. Solidity).</p>

<p>In this simple smart contract, we first define a simple <code>Dog</code> constructor that takes in a stringified json and creates a <code>Dog</code> object.</p>

<p>Then, we define the main contract with only a few functions: <code>init</code>, <code>addDog</code>, and <code>getDogs</code>. When you define an <code>init</code> function, this will be executed when you first deploy your smtart contract to Nebulas. For example, if you want to <em>populate</em> your contract with a few cute dogs before users upload new dogs, this is the right place.</p>

<p>If you already know JavaSript, every line should be familar except for the lines that have <code>LocalContractStorage</code> in them. <code>LocalContractStorage</code> is a reserved function, which lets you have access to Nebulas&#39; storage. Think of <code>LocalContractStorage.defineProperty(this, &quot;numDogs&quot;)</code> as saying <em>&quot;I am going to create a persistent variable <code>numDogs</code> in Nebulas&quot;</em>. The difference between <code>defineProperty</code> and <code>defineMapProperty</code> is simply that the former is a primitive-type store while the latter is a key-value store.</p>
<h2 id='deploy-smart-contract'>Deploy Smart Contract</h2>
<blockquote>
<p>Download Web Wallet</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>git clone git@github.com:nebulasio/web-wallet.git
<span class="gp">$ </span><span class="nb">cd </span>web-wallet

// Open index.html <span class="k">in </span>your browser and create a wallet on Testnet
</code></pre>
<p>We are ready to deploy our simple contract to Nebulas. To deploy a contract to Nebulas, you need to have some NAS, the currency used on Nebulas&#39; network. To get NAS and deploy a contract to Nebulas, you need the <a href="https://github.com/nebulasio/web-wallet">Web Wallet</a>. Download it and open <code>index.html</code> in your browser to see the interface.</p>

<p><img src="images/web-wallet1.jpg" alt="Web Wallet" /></p>

<p>We are going to deploy our contract to Testnet. Think of Testnet as a staging server and Mainnet as production server. We will deploy to Testnet because it will let us test our contract without spending real NAS. You can ask for free NAS on Testnet by visiting the <a href="https://testnet.nebulas.io/claim">Faucet</a>. For wallet address, you can use the one you just created. You will have your free NAS within minutes.</p>

<p>Now that we have some NAS on Testnet, we can finally deploy our contract to Testnet. Go to the Contract tab, and simply copy our contract&#39;s content and paste it into the code section.</p>

<p><img src="images/deploy.jpg" alt="Deploy" /></p>

<p>After you deploy (i.e. submit) your contract, you will get the transaction hash and the deployed contract&#39;s address. Copy the address, as we will have to use it in our React app to interact with the contract.</p>

<p><img src="images/contract-address.jpg" alt="Contract Address" /></p>

<p>Congratulations! You have your first contract deployed to Nebulas.</p>
<h2 id='read-from-smart-contract'>Read from Smart Contract</h2>
<blockquote>
<p>Install Nebulas package in your React app</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>yarn add nebulas
</code></pre>
<blockquote>
<p>Use the dog objects from contract in your React app</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span>
<span class="kr">import</span> <span class="nx">nebulas</span> <span class="nx">from</span> <span class="s1">'nebulas'</span>

<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">dogs</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">componentWillMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fetchDogs</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="nx">fetchDogs</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">CONTRACT_ADDRESS</span> <span class="o">=</span> <span class="s2">"YOUR_CONTRACT_ADDRESS"</span>
    <span class="kr">const</span> <span class="nx">AUTHOR_ADDRESS</span> <span class="o">=</span> <span class="s2">"YOUR_WALLET_ADDRESS"</span>
    <span class="kr">const</span> <span class="nx">NEBULAS_URL</span> <span class="o">=</span> <span class="s2">"https://testnet.nebulas.io"</span>
    <span class="kr">const</span> <span class="nx">Account</span> <span class="o">=</span> <span class="nx">nebulas</span><span class="p">.</span><span class="nx">Account</span>
    <span class="kr">const</span> <span class="nx">neb</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nebulas</span><span class="p">.</span><span class="nx">Neb</span><span class="p">()</span>
    <span class="kr">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">nebulas</span><span class="p">.</span><span class="nx">HttpRequest</span><span class="p">(</span><span class="nx">NEBULAS_URL</span><span class="p">)</span>
    <span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="s2">"0"</span>
    <span class="kr">const</span> <span class="nx">nonce</span> <span class="o">=</span> <span class="s2">"0"</span>
    <span class="kr">const</span> <span class="nx">gas_price</span> <span class="o">=</span> <span class="s2">"1000000"</span>
    <span class="kr">const</span> <span class="nx">gas_limit</span> <span class="o">=</span> <span class="s2">"2000000"</span>
    <span class="kr">const</span> <span class="nx">callFunction</span> <span class="o">=</span> <span class="s2">"getDogs"</span>
    <span class="kr">const</span> <span class="nx">callArgs</span> <span class="o">=</span> <span class="s2">""</span>  
    <span class="kr">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">"function"</span><span class="p">:</span> <span class="nx">callFunction</span><span class="p">,</span>
      <span class="s2">"args"</span><span class="p">:</span> <span class="nx">callArgs</span>
    <span class="p">}</span>

    <span class="nx">neb</span><span class="p">.</span><span class="nx">setRequest</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span>
    <span class="nx">neb</span><span class="p">.</span><span class="nx">api</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
      <span class="nx">AUTHOR_ADDRESS</span><span class="p">,</span>
      <span class="nx">CONTRACT_ADDRESS</span><span class="p">,</span>
      <span class="nx">value</span><span class="p">,</span> <span class="nx">nonce</span><span class="p">,</span>
      <span class="nx">gas_price</span><span class="p">,</span> <span class="nx">gas_limit</span><span class="p">,</span>
      <span class="nx">contract</span>
    <span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">resp</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">dogs</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">resp</span><span class="p">.</span><span class="nx">result</span><span class="p">),</span>
      <span class="p">})</span>
    <span class="p">}).</span><span class="k">catch</span><span class="p">((</span><span class="nx">err</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"error:"</span> <span class="o">+</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">dogs</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">dog</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/div&gt; </span><span class="err"> 
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Now that we have deployed our contract to Nebulas, we are ready to replace our mock data in our React app with actual the data from our contract in Nebulas.</p>

<p>To interact with the smart contract, you need to install the <a href="https://www.npmjs.com/package/nebulas">nebulas package</a> in your React app. Then, we will call the <code>getDogs()</code> function in our smart contract via the API in <code>componentWillMount()</code> and update our state. For now, do not worry too much about the parameters we pass into <code>neb.api.call</code> as you will get used to them naturally as you interact more with your contract in future.</p>

<p>If you did everything correctly, you should see exactly the same screen as you saw when you go to your React app. However this time, the dog objects are coming straight from the smart contract instead of the static mock data. After all, interacting with Nebulas is just as simple as interacting with a 3rd-party API service.</p>
<h2 id='write-to-smart-contract'>Write to Smart Contract</h2>
<blockquote>
<p>Install <a href="https://www.npmjs.com/package/nebpay">nebpay</a> package</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="gp">$ </span>yarn add nebpay
</code></pre>
<blockquote>
<p>Add a button to add a dog and the corresponding handler</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'react'</span>
<span class="kr">import</span> <span class="nx">nebulas</span> <span class="nx">from</span> <span class="s1">'nebulas'</span>
<span class="kr">import</span> <span class="nx">NebPay</span> <span class="nx">from</span> <span class="s1">'nebpay'</span>

<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="nx">onAddDog</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">newDog</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s2">"myDog"</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s2">"someUrl.jpg"</span>
    <span class="p">}</span>
    <span class="kr">const</span> <span class="nx">nebPay</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NebPay</span><span class="p">()</span>
    <span class="kr">const</span> <span class="nx">price</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="kr">const</span> <span class="nx">callFunction</span> <span class="o">=</span> <span class="s2">"addDog"</span>
    <span class="kr">const</span> <span class="nx">callArgs</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">([</span><span class="nx">newDog</span><span class="p">])</span>
    <span class="kr">const</span> <span class="nx">opts</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nx">nebPay</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
      <span class="nx">CONTRACT_ADDRESS</span><span class="p">,</span>
      <span class="nx">price</span><span class="p">,</span>
      <span class="nx">callFunction</span><span class="p">,</span>
      <span class="nx">callArgs</span><span class="p">,</span>
      <span class="nx">opts</span><span class="p">,</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span><span class="nx">dogs</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">dogs</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">dog</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dog</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>          <span class="p">))}</span>
        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">onAddDog</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Add</span> <span class="nx">Dog</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Remember how we wanted to let users add dogs to our contract? Since our contract already has <code>addDog()</code> function, we just need to add a way for our React app to call this function. In other words, we need to add a button and its corresponding handler. For now, let&#39;s skip adding an input field and just have users add <em>a dog</em> with the same name and image.</p>

<p>When you look at the function <code>onAddDog()</code> on the right side, you will notice that it is extremly similar to the function <code>fetchDogs()</code> we wrote above. The biggest difference is that instead of using the nebulas api directly, we are now using the <code>nebpay</code> package. This package lets users interact with your smart contract directly via either the <a href="https://github.com/ChengOrangeJu/WebExtensionWallet">Chrome extension</a> or the mobile nebulas wallet. In other words, <code>nebpay</code> lets end users sign and send transactions to your smart contract.</p>

<p>Why is it needed? It&#39;s because altering the state in Nebulas blockchain requires a small amount of NAS, just like how Ethereum requires GAS for altering its state. While calling the <code>getDogs()</code> function does not alter the state, <code>addDog()</code> does. Consequently, users who want to add a dog to your smart contract must sign and send the transaction to your contract by paying a small fee. <code>nebpay</code> allows you to implement such interaction as easily as just using the <code>nebulas</code> package.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
